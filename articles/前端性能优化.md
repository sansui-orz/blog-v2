# å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ€»ç»“

[tag]:å‰ç«¯|æ€§èƒ½|ä¼˜åŒ–
[create]:2020-07-20

â€œå°‘å¹´ï¼Œä½“éªŒè¿‡å¥æ­¥å¦‚é£çš„æ„Ÿè§‰å—ï¼Ÿâ€ -- æ¬ç –äºº

## é¦–å±é¦–æ¬¡åŠ è½½ä¼˜åŒ–

ä¸ºä»€ä¹ˆå«é¦–å±é¦–æ¬¡åŠ è½½ä¼˜åŒ–å‘¢ï¼Œæ˜¯å› ä¸ºé¦–æ¬¡çš„æ—¶å€™æ²¡æœ‰ç¼“å­˜ï¼Œè¿™æ—¶å€™æœ€è€ƒéªŒäº§å“çš„ä¼˜åŒ–ç¨‹åº¦ï¼Œè™½ç„¶åŠ è½½å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºç”¨æˆ·çš„ç½‘ç»œçŠ¶æ€ï¼Œä½†æ˜¯æ˜¾ç„¶è¿™å¹¶ä¸èƒ½è¯´æœè€æ¿ã€‚

### åˆ†åŒ…åŠ è½½

æåˆ°é¦–å±åŠ è½½ä¼˜åŒ–ï¼Œæœ€å…ˆæƒ³åˆ°çš„åº”è¯¥è¿˜æ˜¯åˆ†åŒ…åŠ è½½ã€‚åˆ†åŒ…åŠ è½½æŒ‡çš„å°±æ˜¯é€šè¿‡ä»£ç æ‹†åˆ†çš„æ‰‹æ®µï¼Œå°†é¦–å±ä»£ç èµ„æºå•ç‹¬åˆ†å‡ºä¸€ä¸ªä»£ç åŒ…ï¼ˆjsæ–‡ä»¶ï¼‰ï¼Œå½“ç„¶ï¼Œå¤§éƒ¨åˆ†æ—¶å€™è¿˜å¯èƒ½ä¼šæ‹†å‡ºä¸€ä¸ªå…¬ç”¨åŒ…ç”¨æ¥æ‰¿è½½ä¸€äº›å…¬ç”¨åº“ï¼ˆå¦‚react.js / axios.jsç­‰ï¼‰ã€‚

è€Œåˆ†åŒ…çš„æ‰‹æ®µåœ¨æ—¥å¸¸å·¥ä½œä¸­å·²ç»æ˜¯ååˆ†å¸¸è§äº†ï¼Œä¸è®ºæ˜¯webpackåˆ†åŒ…ï¼Œå°ç¨‹åºåˆ†åŒ…ï¼Œäº¦æˆ–æ˜¯å°æ¸¸æˆåˆ†åŒ…ã€‚ç›®å‰éƒ½å·²ç»æä¾›äº†æ¯”è¾ƒæˆç†Ÿçš„è§£å†³æ–¹æ¡ˆã€‚

è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹è¿™å‡ ç§åˆ†åŒ…æ–¹å¼çš„ç”¨æ³•ï¼š

#### webpackåˆ†åŒ…

```javascript
const path = require('path');
const webpack = require('webpack');
const HTMLWebpackPlugin = require('html-webpack-plugin');

module.exports = {
  entry: {
    index: './src/index.js',
    another: './src/another-module.js'
  },
  plugins: [
    new HTMLWebpackPlugin({
      title: 'Code Splitting'
    }),
    new webpack.optimize.CommonsChunkPlugin({
      name: 'common' // æŒ‡å®šå…¬å…± bundle çš„åç§°ã€‚
    })
  ],
  output: {
    filename: '[name].bundle.js',
    path: path.resolve(__dirname, 'dist')
  }
};
```

ä»£ç å¦‚ä¸Šï¼Œè¯¥webpackæŒ‡å®šäº†ä¸¤ä¸ª`entry`ï¼Œå¹¶ä¸”ä½¿ç”¨`CommonsChunkPlugin`æ’ä»¶å°†å…¬ç”¨æ¨¡å—æ‹†æˆä¸€ä¸ªç‹¬ç«‹çš„ä»£ç åŒ…ï¼Œæœ€ç»ˆä¼šç”Ÿæˆ`index.bundle.js`ï¼Œ`another.bundle.js`ï¼Œ`common.bundle.js`ã€‚

è€Œåœ¨åŠ è½½çš„æ—¶å€™åªä¼šåŠ è½½æŒ‡å®šçš„`entry`åŒ…ä»¥åŠå…¬å…±åŒ…ï¼Œå¦‚æœåœ¨ä¸šåŠ¡ä»£ç æ¯”è¾ƒåºå¤§çš„æ—¶å€™ï¼Œå°†éé¦–é¡µçš„ï¼Œéå¿…è¦çš„ï¼Œéå¸¸ç”¨çš„ä»£ç å•ç‹¬æ‹†åˆ†æˆä¸€ä¸ªæˆ–å‡ ä¸ªåŒ…å°±éå¸¸çš„å¿…è¦äº†ã€‚

ps: è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯ï¼Œä¸éœ€è¦æŒ‡å®šå¤šä¸ª`entry`ï¼Œè€Œæ˜¯ä½¿ç”¨[`import()`åŠ¨æ€åŠ è½½åŠŸèƒ½](https://www.webpackjs.com/api/module-methods/#import-)

#### å°ç¨‹åº(ä»¥å¾®ä¿¡å°ç¨‹åºä¸ºä¾‹)åˆ†åŒ…

å°ç¨‹åºå†…åˆ†åŒ…åˆå¯ä»¥æœ‰ä¸¤ç§å½¢å¼ï¼Œç¬¬ä¸€ç§æ˜¯å¸¸è§„çš„åˆ†åŒ…ï¼Œå³åˆ†ä¸ºä¸»åŒ…ä»¥åŠå¤šä¸ªå°åŒ…ã€‚ç¬¬äºŒç§åˆ™æ˜¯æ ¹æ®ç‹¬ç«‹åŠŸèƒ½æ‹†åˆ†å‡ºç‹¬ç«‹åŒ…ã€‚

é¦–å…ˆæ˜¯å¸¸è§„åˆ†åŒ…ï¼Œåªéœ€è¦åœ¨`app.json`å†…è®¾ç½®`subpackages`å­—æ®µï¼Œåœ¨æ‰“åŒ…æ˜¯æ„å»ºå·¥å…·å°±ä¼šå°†ä»£ç æŒ‰ç…§é…ç½®æ‰“åŒ…æˆå¤šä¸ªåŒ…ã€‚

æ³¨æ„çš„æ˜¯é…ç½®æ˜¯æŒ‰ç…§é¡µé¢è·¯å¾„æ¥åŒºåˆ†åˆ†åŒ…é€»è¾‘çš„ï¼Œé‚£ä¹ˆæ­¤æ—¶å¦‚æœå¤šä¸ªå­åŒ…åº”ç”¨äº†åŒä¸€æ¨¡å—ï¼Œé‚£ä¹ˆè¯¥æ¨¡å—å°†ä¼šè¢«æ‰“å…¥ä¸»åŒ…ï¼Œè¿™æ ·æ‰èƒ½å¤Ÿè¢«å¤šä¸ªå­åŒ…å¤ç”¨ã€‚

æ‰€ä»¥æ‰“åŒ…é€»è¾‘ä¸€èˆ¬éµå¾ªâ€œé¦–é¡µï¼ˆæˆ–è€…å‡ ä¸ªè®¿é—®é‡å¤§çš„ï¼‰é¡µé¢å•ç‹¬ä¸€ä¸ªåŒ…ï¼Œå…¶ä»–é¡µé¢åˆ™æ ¹æ®åŠŸèƒ½æ˜¯å¦é€’è¿›æˆ–è€¦åˆè¿›è¡Œæ‹†åˆ†â€çš„è§„åˆ™ã€‚

```json
{
  "pages":[
    "pages/index",
    "pages/logs"
  ],
  "subpackages": [
    {
      "root": "packageA",
      "pages": [
        "pages/cat",
        "pages/dog"
      ]
    }, {
      "root": "packageB",
      "name": "pack2",
      "pages": [
        "pages/apple",
        "pages/banana"
      ]
    }
  ]
}
```

ç¬¬äºŒç§å½¢å¼æ˜¯æ‹†åˆ†ç‹¬ç«‹åŒ…ï¼Œè¿™ç§æ¨¡å¼ä¸€èˆ¬è¿ç”¨åœ¨æŸä¸ªè®¿é—®é‡å¤§ï¼Œç‹¬ç«‹ä¸”åŠŸèƒ½å•ä¸€çš„é¡µé¢ã€‚

æ¯”å¦‚ï¼šæŸæŸç«è½¦ç¥¨æŠ¢ç¥¨å°ç¨‹åºçš„åˆ†äº«å¥½å‹åŠ é€Ÿï¼ŒæŸæŸç”Ÿé²œå°ç¨‹åºçš„åˆ†äº«çº¢åŒ…é¡µé¢ç­‰ã€‚

å¯ä»¥æ³¨æ„åˆ°åº”ç”¨ç‹¬ç«‹åŒ…çš„åœºæ™¯éƒ½æ˜¯ç¬¦åˆâ€œè®¿é—®é‡å¤§ï¼Œç‹¬ç«‹ï¼ŒåŠŸèƒ½å•ä¸€â€çš„åœºæ™¯ï¼Œå› ä¸ºè¿™äº›åœºæ™¯ä¸ä¾èµ–å…¶ä»–é€»è¾‘ï¼Œä¸€èˆ¬ä»…ä»…æ˜¯æ‹‰å›æµç”¨æˆ·ï¼Œå¼•å¯¼ç”¨æˆ·è¿›å…¥å°ç¨‹åºæ¶ˆè´¹ï¼Œæ‰€ä»¥éœ€è¦åšåˆ°å¿«é€Ÿå“åº”ï¼Œå…ˆè®©ç”¨æˆ·è¿›æ¥ï¼Œå†é€šè¿‡çº¢åŒ…/æŠ˜æ‰£çš„è¯±æƒ‘å¼•å¯¼ç”¨æˆ·è¿›ä¸€æ­¥æ¶ˆè´¹ã€‚

è¿™æ—¶å€™å°±éå¸¸è€ƒéªŒè¯¥é¡µé¢çš„åŠ è½½æ€§èƒ½ï¼Œä¸€èˆ¬è¿™ç§åœºæ™¯éƒ½æ˜¯ç”¨æˆ·ç‚¹å‡»åˆ†äº«å¡ç‰‡è¿›å…¥ï¼Œç›®æ ‡æ€§è¾ƒå·®ï¼Œå¦‚é‡åˆ°åŠ è½½æ—¶é—´è¾ƒé•¿å¾ˆå®¹æ˜“å¤±å»è€å¿ƒç›´æ¥é€€å‡ºã€‚è€Œç‹¬ç«‹åŒ…åˆ™ååˆ†å®Œç¾çš„æ»¡è¶³äº†è¿™ç§åœºæ™¯éœ€æ±‚ã€‚

é…ç½®æ–¹é¢ï¼Œä»…éœ€å°†è¯¥åˆ†åŒ…çš„`independent`è®¾ä¸ºtrueå°±å¯ä»¥äº†ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥é¡µé¢ä¸è¦åŒ…å«å¤§çš„æ¨¡å—ï¼Œå¦åˆ™æ‰“å‡ºæ¥çš„åŒ…å¤§äº†ï¼Œå°±èµ·ä¸åˆ°â€å°è€Œç²¾â€œçš„ä½œç”¨äº†ã€‚ä¸”ç‹¬ç«‹åŒ…ä¸å…¶ä»–åŒ…æ˜¯ç‹¬ç«‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å°±ç®—ä¸»åŒ…ä¸ç‹¬ç«‹åŒ…å¼•ç”¨äº†åŒä¸€æ¨¡å—ï¼Œé‚£ç‹¬ç«‹æŠ¥ä¸ä¸»åŒ…éƒ½ä¼šåŒ…å«è¯¥æ¨¡å—ã€‚

```json
{
  "pages": [
    "pages/index",
    "pages/logs"
  ],
  "subpackages": [
    {
      "root": "moduleA",
      "pages": [
        "pages/rabbit",
        "pages/squirrel"
      ]
    }, {
      "root": "moduleB",
      "pages": [
        "pages/pear",
        "pages/pineapple"
      ],
      "independent": true
    }
  ]
}
```

#### å°æ¸¸æˆåˆ†åŒ…(ä»¥å¾®ä¿¡å°æ¸¸æˆ && cocos creatorä¸ºä¾‹)

å¾®ä¿¡å°æ¸¸æˆä¹Ÿæ”¯æŒåˆ†åŒ…åŠ è½½çš„é…ç½®ï¼Œé…ç½®æ–¹å¼è·Ÿå°ç¨‹åºé…ç½®æ˜¯ä¸€æ ·çš„ï¼Œåªéœ€è¦é…ç½®ä¸€ä¸‹`game.json`çš„`subpackages`å­—æ®µå°±å¯ä»¥äº†ã€‚

```json
{
  ...
  "subpackages": [
    {
      "name": "stage1",
      "root": "stage1/" // å¯ä»¥æŒ‡å®šä¸€ä¸ªç›®å½•ï¼Œç›®å½•æ ¹ç›®å½•ä¸‹çš„ game.js ä¼šä½œä¸ºå…¥å£æ–‡ä»¶ï¼Œç›®å½•ä¸‹æ‰€æœ‰èµ„æºå°†ä¼šç»Ÿä¸€æ‰“åŒ…
    }, {
      "name": "stage2",
      "root": "stage2.js" // ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ª JS æ–‡ä»¶
    }
  ]
  ...
}
```

è€ŒåŠ è½½åˆ™ä½¿ç”¨[wx.loadSubpackage()](https://developers.weixin.qq.com/minigame/dev/guide/base-ability/sub-packages.html)apiæ¥è§¦å‘åˆ†åŒ…çš„ä¸‹è½½ã€‚

è€Œcocos creatorä¹Ÿåœ¨v2.4.0ç‰ˆæœ¬æ”¯æŒäº†åˆ†åŒ…çš„[é…ç½®](https://docs.cocos.com/creator/manual/zh/scripting/asset-bundle.html#%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95)ï¼Œ
é…ç½®çš„æ–¹å¼æ˜¯åœ¨ç¼–è¾‘å†…æ ¹æ®æ–‡ä»¶å¤¹é…ç½®æ¥åˆ†åŒ…ã€‚

![åˆ†åŒ…é…ç½®ç¤ºä¾‹](https://lms-flies.oss-cn-guangzhou.aliyuncs.com/blog/imgs/inspector.png!trans_webp)

åŠ è½½åˆ™æ˜¯ä½¿ç”¨[cc.assetManager.loadBundle()](https://docs.cocos.com/creator/manual/zh/scripting/asset-bundle.html#%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95)apiæ¥æ§åˆ¶åˆ†åŒ…çš„åŠ è½½ã€‚

å¾ˆä¸å¹¸çš„æ˜¯ï¼Œv2.4.0åˆšå‡ºä¸åˆ°ä¸€ä¸ªæœˆï¼Œæš‚æ—¶è¿˜æ²¡ä¸Šæ‰‹å°è¯•ï¼Œä¸è¿‡æŒ‰ç…§æƒ¯ä¾‹ï¼Œä¼°è®¡å‘ä¸å°‘ã€‚

ä»¥ä¸Šå°±æ˜¯ä»£ç åˆ†åŒ…çš„å‡ ä¸ªåœºæ™¯äº†ï¼Œå¾€å¾€ä»£ç åˆ†åŒ…äº§ç”Ÿçš„æ•ˆç›Šæ˜¯ç«‹ç«¿è§å½±çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®ƒé¢‘ç¹è¢«æèµ·çš„åŸå› ï¼Œé¦–æ¬¡åŠ è½½çš„èµ„æºå°‘äº†ï¼ŒåŠ è½½é€Ÿåº¦è‡ªç„¶å°±ä¸Šæ¥äº†ã€‚

### æœåŠ¡ç«¯æ¸²æŸ“

æœåŠ¡ç«¯æ¸²æŸ“ä¸»è¦è§£å†³çš„æ˜¯ä¸¤ä¸ªé—®é¢˜

1. é¦–å±æ¸²æŸ“åŠ é€Ÿ

2. SEOä¼˜åŒ–

æœåŠ¡ç«¯æ¸²æŸ“ä¸»è¦æ˜¯åœ¨æœåŠ¡ç«¯æå‰æ¸²æŸ“å¥½domï¼Œç„¶åæµè§ˆå™¨åœ¨æ–‡æ¡£è¿”å›ä¹‹åä¸éœ€è¦ç­‰å¾…ä¸è¿è¡Œjså³å¯ç«‹å³åœ¨é¡µé¢ä¸­å‘ˆç°å‡ºå†…å®¹ï¼Œè€Œæœç´¢å¼•æ“ä¹Ÿå¯ä»¥é€šè¿‡æ£€ç´¢æ–‡æ¡£å†…å®¹ï¼Œæé«˜é¡µé¢è¢«å‘ˆç°çš„å‡ ç‡ï¼ˆå®¢æˆ·ç«¯æ¸²æŸ“åˆ™ä¸è¡Œï¼Œå› ä¸ºæ–‡æ¡£æ˜¯ç©ºçš„ï¼‰ã€‚

ä½†æ˜¯æœåŠ¡ç«¯æ¸²æŸ“ä¼šå°†åŸæœ¬ç”±ç”¨æˆ·æ‰¿æ‹…çš„æ¸²æŸ“æˆæœ¬é›†ä¸­åˆ°æœåŠ¡å™¨ä¸Šï¼Œæ‰€ä»¥åœ¨æˆæœ¬ä¸æ•ˆç›Šä¹‹é—´å¦‚ä½•å‡è¡¡å°±è¦çœ‹å„è‡ªä¸šåŠ¡çš„è€ƒé‡äº†ã€‚

è¿™é‡Œæœ‰ä¸€ç¯‡[reactæœåŠ¡ç«¯æ¸²æŸ“é¡¹ç›®æ­å»º](https://limaosheng.top/article/4d37df30f18a94691d2db50df55a4e13-6428f8ce98aebc5faacc01038f3478dc-1.html), æ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹ã€‚

### å›¾ç‰‡ä¼˜åŒ–

é€šå¸¸ä¸€ä¸ªäº’è”ç½‘é¡¹ç›®å°‘ä¸äº†å›¾ç‰‡çš„å‡ºç°ï¼Œwebæœ€åˆä¹Ÿåªæ˜¯ç”¨æ¥æ‰¿è½½æ–‡æœ¬ä¸å›¾ç‰‡ï¼Œåªæ˜¯åœ¨æ—¶ä»£å‘å±•ä¸‹é€æ¸æ‰©å……äº†å…¶åŠŸèƒ½ï¼Œæ‰å½¢æˆç›®å‰äº”èŠ±å…«é—¨çš„åº”ç”¨åœºæ™¯ï¼ˆè§†é¢‘/éŸ³é¢‘ç­‰ï¼‰ã€‚

è€Œå½’æ ¹ç»“åº•ï¼Œæ–‡æœ¬ä¸å›¾ç‰‡çš„åº”ç”¨ä¹Ÿæ˜¯é‡ä¸­ä¹‹é‡ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œå›¾ç‰‡çš„è´¨é‡è¶Šå¤§ï¼ŒåŠ è½½åˆ™è¶Šæ…¢ã€‚åº”è¯¥æ¥è§¦è¿‡äº’è”ç½‘çš„äººéƒ½æœ‰ç»å†è¿‡ç½‘ç»œæ…¢çš„æ—¶å€™ï¼Œæ‰“å¼€ä¸€ä¸ªç½‘é¡µè‚¯å®šæ˜¯æ–‡å­—å…ˆå‡ºæ¥ï¼Œç„¶åæ‰æ˜¯å›¾ç‰‡ã€‚

è¿™æ˜¯å› ä¸ºæ–‡æœ¬å°ä¸”å®ƒæ˜¯è·Ÿæ–‡æ¡£ä¸€èµ·è¢«åŠ è½½çš„ï¼Œè€Œå›¾ç‰‡åˆ™æ˜¯åœ¨æ–‡æ¡£è¢«è§£æä¸­æˆ–è§£æåæ‰å‘å‡ºçš„è¯·æ±‚ã€‚åœ¨æœ¬èº«åŠ è½½å°±æ¯”è¾ƒé åçš„æƒ…å†µä¸‹ï¼Œå¦‚æœå›¾ç‰‡è¿˜å¤§ï¼Œåˆ™ä¼šå‡ºç°åŠ è½½å¾ˆä¹…ç”šè‡³åŠ è½½å¤±è´¥çš„æƒ…å†µï¼Œæˆ–è®¸è¿™ç§çŠ¶å†µåœ¨ä½ çœ‹æ¥æ­£å¸¸ï¼Œä½†æ˜¯åœ¨ç”¨æˆ·çœ¼ä¸­ï¼Œå°±æ˜¯ä¼˜åŒ–ä¸å½“æˆ–è€…æ˜¯ä¸ªbugã€‚

ç”±äºå›¾ç‰‡ä¼˜åŒ–å†…å®¹æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥å•ç‹¬æ‹å‡ºæ¥ä½œä¸ºä¸€å—ï¼Œè¯·ç§»æ­¥[å›¾ç‰‡ä¼˜åŒ–å®è·µ](https://limaosheng.top/article/267a3baccfb99e62410b7ee01fcda399-3d4b2527bae6821f758a53e95bf42cb5-1.html)

### ä½¿ç”¨CDN

å…³äºcdnçš„æ–‡ç« äº”èŠ±å…«é—¨ï¼Œæ²¡çœ‹è¿‡çš„èµ¶ç´§ç™¾åº¦ä¸€ä¸‹ã€‚ç®€å•æ¥è¯´CDNå°±æ˜¯åœ¨ä¸–ç•Œå„åœ°éƒ¨ç½²æœåŠ¡å™¨ï¼Œå½“ä½ éœ€è¦ä¸€ä¸ªé™æ€èµ„æºçš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥ä»ç¦»ä½ æœ€è¿‘çš„é‚£å°æœåŠ¡å™¨ä¸Šè·å–ã€‚

æ¯”å¦‚äººåœ¨åŒ—äº¬ï¼Œä½†æ˜¯ä½ çš„æœåŠ¡å™¨åœ¨çº½çº¦ï¼Œé‚£ä½ è¦è·å–ä¸ªèµ„æºå°±å¾—è·‘ä¸€ä¸ªåœ°çƒå‘¨é•¿é‚£ä¹ˆè¿œï¼ˆä¸€æ¥ä¸€å›ï¼‰ã€‚ä½†æ˜¯å¦‚æœä½ æŠŠé™æ€èµ„æºéƒ¨ç½²åˆ°åŒ—äº¬çš„cdnæœåŠ¡å™¨ä¸Šï¼Œé‚£å°±æ˜¯ä¸¤æ­¥è·¯çš„äº‹æƒ…ï¼Œcdnå°±æ˜¯é‚£ä¹ˆç‰›é€¼ã€‚

è€Œä¸€èˆ¬cdnæœåŠ¡å™¨çš„åœ°å€è·Ÿä¸šåŠ¡æœåŠ¡å™¨åœ°å€æ˜¯åˆ†å¼€çš„ï¼Œè¿™é—´æ¥çš„å¸®ä½ æŠŠèµ„æºä¸apiçš„åŸŸååŒºåˆ†å¼€ï¼Œè¿™æ ·åšæœ‰ä¸¤ä¸ªå¥½å¤„ï¼š

1. è¯·æ±‚èµ„æºä¸ä¼šæºå¸¦cookieã€‚ï¼ˆç»Ÿä¸€åŸŸåä¸‹çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šæºå¸¦cookieï¼‰

2. è¯·æ±‚å¹¶å‘æ•°å¢åŠ ï¼ˆChromeçš„ä¸€ä¸ªtabä¸­åŒåŸŸåä¸‹æœ€å¤šå¹¶å‘6æ¡è¯·æ±‚ï¼Œå¤šçš„ä¼šæ’é˜Ÿï¼‰

æ‰€ä»¥èƒ½ç”¨cdnå°±ç”¨ä¸Šï¼Œåæ­£å¯¹äºå‰ç«¯æ¥è¯´ä¹Ÿå°±æ˜¯ä¸€é”®éƒ¨ç½²çš„äº‹å„¿ã€‚

### åˆå¹¶æ•£ç¢å°æ–‡ä»¶ï¼Œæ‹†åˆ†èµ„æºåŸŸåï¼Œå»¶è¿ŸåŠ è½½å¤§æ–‡ä»¶

å‰é¢å¤šå¤„åœ°æ–¹æåˆ°æµè§ˆå™¨æœ‰å¹¶å‘æ•°é™åˆ¶ï¼Œè€Œä¸€èˆ¬ä¸€ä¸ªç½‘ç«™ä¸€æ‰“å¼€å°±ä¼šæœ‰åå‡ äºŒåæ¡ä»¥ä¸Šçš„è¯·æ±‚è¢«å‘å‡ºï¼Œæ­¤æ—¶å°±å¾ˆå¤§å¯èƒ½ä¼šè§¦å‘è¯·æ±‚æ•°ä¸Šé™çš„é™åˆ¶äº†ã€‚

è€Œå¦‚æœä½ åœ¨é¡µé¢ä¸­åŠ è½½äº†å¤šä¸ªå¤§æ–‡ä»¶ï¼Œé‚£å°±å¾ˆå¯èƒ½è¯·æ±‚æ•°è¢«è¿™äº›å¤§æ–‡ä»¶å ç”¨ä»è€Œå¯¼è‡´å…¶ä»–èµ„æºè¯·æ±‚æ— æ³•å‘å‡ºã€‚ä¸€èˆ¬æ¥è¯´ï¼Œâ€js + css + å¤§å›¾â€œå†åŠ ä¸€äº›éŸ³è§†é¢‘ï¼Œå¾ˆå®¹æ˜“å°±å¯ä»¥è¶…è¿‡6ä¸ªå¤§æ–‡ä»¶ã€‚

è¿™æ—¶å€™å°±éœ€è¦å°†æš‚æ—¶ä¸ä¼šä½¿ç”¨åˆ°çš„å¤§æ–‡ä»¶å»¶ååŠ è½½äº†ï¼Œå‰é¢æåˆ°çš„ä»£ç åˆ†åŒ…ä¹Ÿæ˜¯è¿™ä¸ªç›®çš„ï¼Œæ¯”å¦‚åŠ è½½å¤§å›¾æˆ–è€…éŸ³è§†é¢‘ï¼Œå®Œå…¨å¯ä»¥æ”¾åˆ°DOMContentLoadedä¹‹åå†åŠ è½½ï¼Œä¼˜å…ˆä¿è¯jsè·‘èµ·æ¥ï¼Œé¡µé¢èƒ½æœ‰å±•ç¤ºå†…å®¹ã€‚

è€Œåˆå¹¶æ•£ç¢å°æ–‡ä»¶ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæ¯”å¦‚ä½ æœ‰ä¸‰ä¸ªcssåˆ†åˆ«æ˜¯`base.css`, `theme.css`, `page.css`ã€‚è¿™æ—¶å€™åˆå¹¶æˆä¸€ä¸ªåè€Œæ›´å¥½ï¼Œå³å‡å°‘äº†ç½‘ç»œè¯·æ±‚ï¼Œåˆä¸éœ€è¦è€ƒè™‘å…¶ä¸­æŸä¸ªcssåŠ è½½å¤±è´¥çš„å¼‚å¸¸ï¼ˆè¦æ­»ä¸€èµ·æ­»ï¼‰ã€‚

åŒç†è¿˜æœ‰å°å›¾æ ‡çš„åˆå¹¶ï¼Œjsæ–‡ä»¶çš„åˆå¹¶ç­‰ã€‚

 **æ‹†åˆ†èµ„æºåŸŸå** æ˜¯æœ€åçš„ä¼˜åŒ–æ‰‹æ®µï¼Œæ¯•ç«Ÿä¸å¯èƒ½é‚£ä¹ˆå¤šåŸŸåç»™ä½ ç”¨ï¼Œå…¬å¸èµ„æºéƒ½æ˜¯å®è´µçš„ï¼Œä½†æ˜¯çœŸå½“ä½ æŠŠèµ„æºéƒ½åˆå¹¶ä¹‹åè¿˜æ˜¯æœ‰è¿™ä¹ˆå¤šè¯·æ±‚ï¼Œé‚£å°±è¦è®¤çœŸè€ƒè™‘ä¸€ä¸‹æ˜¯å¦æ‹†åˆ†åŸŸåäº†ï¼ˆè¿™ç§æƒ…å†µæˆ‘åœ¨å°æ¸¸æˆä¸­é‡åˆ°è¿‡ï¼‰ã€‚

### ç‰¹æ®Šçš„ä¼˜åŒ–æ‰‹æ®µï¼ˆç¦»çº¿åŒ…ä¸é¢„æ¸²æŸ“ã€æ¨¡ç‰ˆé¡µï¼‰

é¡µé¢çš„æ¸²æŸ“å¿…ç„¶ä¾èµ–å„ç§èµ„æºï¼Œè€Œå¦‚æœæˆ‘ä»¬å¯ä»¥æå‰åŠ è½½å¥½é‚£äº›èµ„æºæ˜¯ä¸æ˜¯ç†è®ºä¸Šå¯ä»¥åšåˆ°å¿«é€Ÿå¯åŠ¨ä¸€ä¸ªé¡µé¢å‘¢ï¼Ÿ

ä½†æ˜¯è‚¯å®šçš„æ˜¯ï¼Œå•çº¯å€Ÿç”¨webä¸æµè§ˆå™¨çš„èƒ½åŠ›æ˜¯æ— æ³•åœ¨ç”¨æˆ·æ²¡æœ‰è®¿é—®è¿‡é¡µé¢ä¹‹å‰å°±æ‹¥æœ‰é¡µé¢çš„èµ„æºç¼“å­˜çš„ã€‚

å¯æ˜¯ç°åœ¨æµè¡Œçš„ **æ··åˆå¼€å‘ï¼ˆHybrid Appï¼‰** å´å¯ä»¥æä¾›è¿™ç§èƒ½åŠ›ã€‚

#### ç¦»çº¿åŒ…

åœ¨åŸç”Ÿå®¢æˆ·ç«¯ï¼Œå¯ä»¥ä¸ºwebå®šåˆ¶ä¸€ç§æå‰è·å¾—é¡µé¢èµ„æºçš„æ‰‹æ®µï¼Œåœ¨åº”ç”¨æ‰“åŒ…æ—¶å†…ç½®ä¸€ä»½å‰ç«¯é¡¹ç›®ä»£ç ï¼Œåœ¨webviewå‘å‡ºè¯·æ±‚çš„æ—¶å€™å¯¹è¯·æ±‚è¿›è¡Œæ‹¦æˆªåŒ¹é…ï¼Œå½“åŒ¹é…æˆåŠŸæ—¶åˆ™ç›´æ¥ä½¿ç”¨ç¦»çº¿èµ„æºï¼Œè¿™å°±æ˜¯ç®€å•çš„ **ç¦»çº¿åŒ…** çš„æ¦‚å¿µã€‚

è¦çŸ¥é“å½“ä½ ä½¿ç”¨ç¦»çº¿èµ„æºçš„é€Ÿåº¦æ˜¯å¾ˆå¿«çš„ï¼Œè¿™èƒ½ç»™ä¸€ä¸ªwebåº”ç”¨çš„ä½“éªŒå¸¦æ¥æå¤§çš„æå‡ã€‚

ä½†æ˜¯è¿™æ ·åšä¹Ÿæœ‰å¼Šç«¯ï¼Œå› ä¸ºwebé¡¹ç›®ä¸€èˆ¬éƒ½å…·å¤‡å¿«é€Ÿè¿­ä»£çš„ç‰¹æ€§ï¼Œå¦‚æœå†…ç½®åˆ°åº”ç”¨åŒ…é‡Œé¢ï¼Œå½“é¡µé¢éœ€è¦æ›´æ–°æ€ä¹ˆåŠï¼Ÿ

è¿™æ—¶æˆ‘ä»¬å°±éœ€è¦æä¾›ä¸€ä»½é…ç½®å»æ§åˆ¶æˆ‘ä»¬çš„ç¦»çº¿åŒ…æ˜¯å¦è¿‡æœŸäº†ã€‚

å‡è®¾æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªjsonæ–‡ä»¶ï¼Œæ–‡ä»¶å†…åŒ…å«ç¦»çº¿åŒ…ç‰ˆæœ¬å·ï¼Œç¦»çº¿èµ„æºåŒ¹é…è§„åˆ™ï¼Œç¦»çº¿åŒ…ä¸‹è½½åœ°å€ç­‰ä¿¡æ¯ï¼Œè€Œå½“åº”ç”¨å¯åŠ¨æ—¶å»æœåŠ¡å™¨ä¸Šè¯·æ±‚æœ€æ–°çš„ç¦»çº¿åŒ…é…ç½®ä¸æœ¬åœ°é…ç½®è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœç‰ˆæœ¬ä¸ä¸€è‡´åˆ™è¦†ç›–æœ¬åœ°ç¼“å­˜ï¼Œè¿™å°±å®Œç¾è§£å†³äº†ç¦»çº¿åŒ…ç‰ˆæœ¬æ§åˆ¶çš„é—®é¢˜äº†ã€‚

ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸»æ–‡æ¡£ä¸åº”è¯¥è¢«ä½œä¸ºç¦»çº¿èµ„æºä¸‹å‘ï¼Œå› ä¸ºå½“ä¸šåŠ¡æ›´æ”¹æ—¶ï¼Œæ‰“åŒ…å‡ºæ¥çš„jsä¸cssçš„hashå˜åŒ–åªæœ‰åœ¨htmlæ–‡æ¡£ä¸­æ‰æœ‰å¼•ç”¨ï¼Œæ‰€ä»¥å¦‚æœhtmlæ–‡æ¡£ä¹Ÿä½¿ç”¨ç¦»çº¿åŒ…ï¼Œåœ¨ç¦»çº¿åŒ…è¿˜æœªæ›´æ–°çš„æƒ…å†µä¸‹ï¼Œä¸»æ–‡æ¡£å°±ä¸€ç›´å¼•ç”¨è€ç‰ˆæœ¬èµ„æºï¼Œè€Œåœ¨çº¿è¯·æ±‚çš„ä¸»æ–‡æ¡£åˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå³ä½¿æ²¡æœ‰å‘½ä¸­ç¦»çº¿èµ„æºï¼Œå®ƒä¹Ÿè¿˜æ˜¯å¯ä»¥è¯·æ±‚åœ¨çº¿èµ„æºï¼Œå¹¶ä¸å½±å“ç”¨æˆ·çš„è®¿é—®ã€‚

 **æ—¢ç„¶ç¦»çº¿åŒ…å·²ç»é‚£ä¹ˆå¼ºå¤§äº†ï¼Œè¿˜æœ‰æ²¡æœ‰è¿›ä¸€æ­¥ä¼˜åŒ–ç©ºé—´å‘¢ï¼Ÿ**

ç¦»çº¿åŒ…åªæ˜¯åŠ è½½é™æ€èµ„æºå¾ˆå¿«è€Œå·²ï¼Œä½†æ˜¯å®ƒè¿˜éœ€è¦åˆå§‹åŒ– webviewçš„è€—æ—¶ï¼Œè¿˜éœ€è¦åŠ è½½ä¸»æ–‡æ¡£ä¸å‘èµ·è¯·æ±‚ã€‚

è¿™äº›æ­¥éª¤æˆ‘ä»¬ä¹Ÿå¯ä»¥æƒ³åŠæ³•å»è¿›è¡Œä¼˜åŒ–ï¼Œå°½é‡å‡å°‘è¿™äº›è€—æ—¶ã€‚è¿™å°±æ¶‰åŠåˆ°å¦ä¸€ä¸ªæŠ€æœ¯ -- **â€œé¢„æ¸²æŸ“â€**ã€‚

#### é¢„æ¸²æŸ“

é¢„æ¸²æŸ“æŒ‡çš„æ˜¯å½“ä½ è¿˜æœªåœ¨ä¸€ä¸ªåº”ç”¨å†…è®¿é—®webæ¨¡å—æ—¶ï¼Œåº”ç”¨å·²ç»æå‰æ¸²æŸ“åè¯¥webæœåŠ¡ï¼Œåªéœ€è¦ç”¨æˆ·ç‚¹å‡»æ—¶è°ƒå‡ºè¯¥webviewï¼Œå³å¯ç«‹å³å‘ˆç°å†…å®¹ã€‚

å¬èµ·æ¥ä¼¼ä¹å¾ˆç®€å•ï¼Œä½†æ˜¯è¿™å…¶ä¸­è¿˜æ˜¯æœ‰å‡ ä¸ªéš¾ç‚¹ã€‚

- ç¬¬ä¸€ï¼Œå½“ä¸€ä¸ªæ··åˆå¼€å‘é¡¹ç›®åŒ…å«å¤šä¸ªwebæ¨¡å—æ—¶ï¼Œå¦‚ä½•çŸ¥é“ç”¨æˆ·ä¼šç‚¹å‡»å“ªä¸ªæ¨¡å—ï¼ˆå…¨éƒ¨æ¨¡å—æ¸²æŸ“ä¸ç°å®ï¼ŒæŸè€—å¤ªå¤§ï¼‰ï¼Ÿ

è¿™å°±æ¶‰åŠåˆ°æ•°æ®åˆ†æäº†ï¼Œåˆ†æç”¨æˆ·æ—¥å¸¸æœ€ç»å¸¸ä½¿ç”¨å“ªä¸ªæ¨¡å—ï¼Œä»¥åŠç”¨æˆ·ç›®å‰è¿›å…¥è·¯å¾„æ˜¯å¦æœ‰æå¼ºç›®çš„æ€§çš„ã€‚å¯¹äºæ–°ç”¨æˆ·åˆ™å¯ä»¥é€šè¿‡åˆ¤æ–­æ¥æºï¼Œä¾é å¤§éƒ¨åˆ†ç”¨æˆ·çš„é€‰æ‹©æ¥å†³å®šæå‰æ¸²æŸ“å“ªä¸ªæœåŠ¡ã€‚

- ç¬¬äºŒï¼Œå¦‚ä½•åŒºåˆ†é¢„æ¸²æŸ“æ—¶çš„loadedä¸æ­£å¸¸æ¸²æŸ“çš„loadedï¼Ÿ

è¿™ç‚¹å¾ˆé‡è¦ï¼Œä¸€èˆ¬çš„äº§å“ä¼šåœ¨é¡µé¢çš„åŠ è½½å‰ï¼ŒåŠ è½½æˆåŠŸåè¿›è¡Œæ•°æ®æ‰“ç‚¹æ¥éªŒè¯è®¿é—®æ¼æ–—ç­‰æ•°æ®ã€‚å¦‚æœè¿™æ—¶å€™ä¸è¿›è¡ŒåŒºåˆ†ï¼Œåˆ™è¿™å—çš„æ•°æ®å°±ä¸å‡†ç¡®ï¼Œå¹¶ä¸”ä¸€äº›é€»è¾‘ä¹Ÿéœ€è¦å®šåˆ¶ï¼Œæ¯”å¦‚è¿›å…¥é¡µé¢è‡ªåŠ¨æ’­æ”¾ï¼Œå±•ç¤ºä¸€ä¸ª3sçš„toastç­‰ã€‚è¿™å¯ä»¥è®©å®¢æˆ·ç«¯æä¾›å®šåˆ¶çš„jsBridge apiæ¥æ§åˆ¶ã€‚

- ç¬¬ä¸‰ï¼Œå¦‚ä½•ä¿è¯ç”¨æˆ·ä¼šæ¶ˆè´¹è¯¥èµ„æºï¼Ÿ

å¯¹äºèµ„æºçš„æŸè€—ï¼Œé¢„æ¸²æŸ“æ˜¯æ— æ³•ä¿è¯ç”¨æˆ·ä¼šè¿›å…¥æ¸²æŸ“çš„é¡µé¢çš„ï¼Œæ‰€ä»¥ä¹Ÿå°±å¯¼è‡´æµªè´¹äº†ç”¨æˆ·æµé‡ä¸åŠ å¤§äº†æœåŠ¡å™¨å‹åŠ›ï¼Œæœ€åç”¨æˆ·å´å¹¶æ²¡æœ‰ä¹°å•ï¼Œç”šè‡³çœ‹åˆ°ä½ çš„åº”ç”¨è¿™ä¹ˆåƒæµé‡æ€’è€Œåˆ appèµ°äººã€‚æš‚æ—¶çœ‹æ¥è¿™æ˜¯æ— è§£çš„ï¼Œåªèƒ½ä»ç¬¬ä¸€ç‚¹çš„è§’åº¦å…¥æ‰‹å°½é‡ä¿è¯ç”¨æˆ·è¿›è¡Œæ¶ˆè´¹ã€‚

### æ¨¡ç‰ˆé¡µ

æ¨¡ç‰ˆé¡µä¸é¢„æ¸²æŸ“ç±»ä¼¼ï¼Œåªä¸è¿‡æ¨¡ç‰ˆé¡µåº”è¯¥æ˜¯ä¸€ä¸ªçº¯é™æ€çš„é¡µé¢ï¼Œåªæœ‰å®ƒè¢«å±•ç¤ºåœ¨å‰å°æ‰ä¼šå»è¯·æ±‚æ•°æ®ã€‚

æ‰€ä»¥æ¨¡ç‰ˆé¡µåªåŒ…å«æ•´ä¸ªé¡µé¢çš„æ‰€æœ‰èµ„æºï¼Œä½†æ˜¯ä¸åŒ…æ‹¬æ•°æ®ï¼Œè¿™æ ·åšæœ‰ä¸€ä¸ªå¥½å¤„å°±æ˜¯å½“é¡µé¢ä¸­æœ‰å¤šä¸ªé¡µé¢å…¥å£æ—¶ï¼Œæ­¤æ—¶é¢„æ¸²æŸ“åªèƒ½æ¸²æŸ“ä¸€ä¸ªwebviewï¼Œä½†æ˜¯å½“ä½ ä¸ç¡®å®šç”¨æˆ·ä¼šè¿›å…¥å“ªä¸ªé¡µé¢æ—¶ï¼Œä½ å¯ä»¥é€‰æ‹©åŠ è½½å¹¶æ¸²æŸ“é¡µé¢çš„åŸºç¡€æ¡†æ¶ï¼ˆåªè¦è¿™äº›é¡µé¢ç”¨çš„æ¡†æ¶éƒ½æ˜¯åŒä¸€å¥—æ¡†æ¶ï¼‰ã€‚

è¿™æ—¶å€™ä¸è®ºç”¨æˆ·ç‚¹å‡»å“ªä¸ªé¡µé¢éƒ½èƒ½å¿«é€Ÿç›¸åº”ï¼Œç„¶åç›´æ¥ä»nativeç«¯é€ä¼ æ•°æ®æˆ–è€…ç›´æ¥å‘èµ·è¯·æ±‚ï¼Œä»è€Œå‡å°‘äº†â€œåˆå§‹åŒ–webviewï¼Œå»ºç«‹é“¾æ¥ï¼Œè§£æå¹¶æ¸²æŸ“ï¼ŒåŠ è½½é™æ€èµ„æºâ€è¿™äº›å·¥ä½œçš„è€—æ—¶ï¼Œç›´æ¥è°ƒå‡ºæ¸²æŸ“å¥½çš„webviewï¼ˆå¦‚æœæœ‰éª¨æ¶å±å°±æ›´å¥½äº†ï¼‰ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯[ **ç¦»çº¿åŒ…**, **é¢„æ¸²æŸ“**, **æ¨¡ç‰ˆé¡µ**] éƒ½æ˜¯åŸºäºæœ‰ä¸€ä¸ªåŸç”Ÿå®¢æˆ·ç«¯ç»™ä½ å…œåº•çš„æƒ…å†µï¼Œä¸€èˆ¬çš„webåº”ç”¨åªèƒ½é€šè¿‡è¿ç”¨ä¸€äº›ç¼“å­˜çš„æ‰‹æ®µè¾¾åˆ°æ‹¥æœ‰ç¼“å­˜åå¤§å¤§åŠ å¿«è®¿é—®é€Ÿåº¦ã€‚å¾€å¾€æœ€ä¼˜çš„åšæ³•æ˜¯å°†è¿™äº›æ‰‹æ®µç»„åˆèµ·æ¥ï¼Œå°±èƒ½è¾¾åˆ°ç¥ç¨åŸç”Ÿåº”ç”¨çš„ç§’å¼€ä½“éªŒã€‚

æˆ–è®¸æœ‰äººä¼šè¯´æˆ‘åªæ˜¯æ‰“å¼€ä¸ªé¡µé¢è€Œå·²ï¼Œå¹¶ä¸éœ€è¦æçš„é‚£ä¹ˆéº»çƒ¦å§ã€‚å…¶å®ä¸ç„¶ï¼Œä»»ä½•å…¬å¸åšä¸€ä¸ªäº§å“éƒ½ä¸ä¼šç§‰æŒç€èƒ½ç”¨å°±å¥½çš„å¿ƒæ€ï¼Œä½“éªŒå½“ç„¶æ˜¯è¶Šä¼˜ç§€è¶Šå¥½ï¼Œè€Œä¸”è¿™å·¥ä½œå¹¶ä¸æ˜¯ç‰¹å¼‚æ€§å¾ˆå¼ºçš„ä¸šåŠ¡åŠŸèƒ½ï¼Œè€Œæ˜¯é€šç”¨çš„åŸºå»ºæ¨¡å—ï¼Œåªè¦æŠŠæ¶å­æ‰“å¥½äº†ï¼Œä¹‹åå°±å¯ä»¥ä¸€åŠ³æ°¸é€¸çš„äº«å—è¿™ä»½ä¼˜å¼‚ä¸æ»‘çš„ä½“éªŒã€‚

### æœ€åçš„å€”å¼ºï¼ˆéª¨æ¶å±æˆ–loadingåŠ¨ç”»ï¼‰

å¦‚æœä»€ä¹ˆæ‰‹æ®µéƒ½ç”¨äº†ï¼Œä½†æ˜¯è€æ¿è¿˜æ˜¯å–œæ¬¢æ¸…æ‰ç¼“å­˜åœ¨å°é—­çš„å•æ‰€çœ‹è‡ªå·±çš„äº§å“çš„è¯ï¼Œé‚£ä½ ä¹Ÿæ²¡è¾™ã€‚

æ­¤æ—¶ä½ å”¯ä¸€è¦æƒ³çš„å°±æ˜¯å¦‚ä½•è®©è€æ¿ï¼ˆç”¨æˆ·ï¼‰æ˜ç™½ï¼Œä¸æ˜¯ä½ çš„ç¨‹åºå‡ºbugäº†ï¼Œæ˜¯ä»–ç½‘ç»œä¸å¥½ã€‚

åšè¿‡vue/reactçš„åº”è¯¥éƒ½é‡åˆ°è¿‡å…³é”®jsä»£ç åŠ è½½æ—¶å¡ä½äº†ï¼Œå¯¼è‡´é¡µé¢ä¸€ç‰‡ç©ºç™½ï¼Œè¿™å°±æ˜¯â€œä½ çš„ç¨‹åºå‡ºbugäº†â€œçš„æ—¥å¸¸å¥—è·¯ã€‚

è€Œè¿™æ—¶å€™ç»™é¡µé¢ä¸€ä¸ªéª¨æ¶å±ï¼Œæˆ–è€…ä¸€ä¸ªloadingåŠ¨ç”»ï¼Œæç¤ºç”¨æˆ·ç°åœ¨æ­£åœ¨åŠ è½½ä¸­ï¼Œè€Œä¸æ˜¯å‡ºç°äº†bugï¼Œä¼šè®©ç”¨æˆ·æ›´åŠ æœ‰è€å¿ƒç­‰å¾…ä¸‹å»ã€‚

## éé¦–å±åŠ è½½ä¼˜åŒ–

### åˆç†åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜

æµè§ˆå™¨è‡ªå·±å°±æ‹¥æœ‰ä¸€å¥—ç¼“å­˜ï¼Œè·Ÿå‰é¢è¯´è¿‡çš„ç¦»çº¿åŒ…å¾ˆç±»ä¼¼ï¼Œå®ƒå¯ä»¥æŠŠé™æ€èµ„æºç¼“å­˜åˆ°å†…å­˜æˆ–ç£ç›˜ï¼Œä¸‹æ¬¡å†è®¿é—®çš„æ—¶å€™ç›´æ¥ä½¿ç”¨ç¼“å­˜èµ„æºï¼Œå¿«åˆ°é£èµ·ã€‚

æµè§ˆå™¨ç¼“å­˜æœ‰ä»¥ä¸‹å‡ ç§:

1. http Cache(disk Cache)

2. Memory Cache

3. Service Worker Cache

4. Push Cache

- **http Cache** åˆç§°æµè§ˆå™¨ç¼“å­˜ï¼Œæ˜¯æ ¹æ®è·å–åˆ°çš„ç½‘ç»œèµ„æºå“åº”å¤´ä¸­çš„ä¿¡æ¯åˆ¤æ–­æ˜¯å¦ç¼“å­˜çš„ä¸€ç§æ‰‹æ®µã€‚

å®ƒåˆåˆ†ä¸º **å¼ºç¼“å­˜** ä¸ **åå•†ç¼“å­˜** ï¼Œå®ƒçš„è¯´æ˜è¯·ç§»æ­¥[Httpç¼“å­˜æœºåˆ¶](https://limaosheng.top/article/b58066a85e6629d0f3def482cd72cc5a-6d3a6155b48b9c57245fcd95a154bf04-1.html)

- **Memory Cache** æ˜¯å†…å­˜ç¼“å­˜ï¼Œä¸€èˆ¬æ¥è¯´æµè§ˆå™¨æœ€å…ˆå°è¯•å‘½ä¸­çš„å°±æ˜¯å†…å­˜ç¼“å­˜ï¼Œå› ä¸ºå®ƒæ˜¯ç›´æ¥ç¼“å­˜åœ¨å†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥å“åº”é€Ÿåº¦æœ€å¿«ã€‚

 ä½†æ˜¯åœ¨å†…å­˜ä¸­çš„ç¼“å­˜åœ¨é¡µé¢å…³é—­æ—¶ï¼Œè¯¥å†…å­˜è¢«é‡Šæ”¾ï¼Œç¼“å­˜ä¹Ÿå°±æ²¡äº†ã€‚è€Œä¸”å› ä¸ºå†…å­˜ç©ºé—´æœ‰é™ï¼Œå®ƒåªä¼šç¼“å­˜ä¸€äº›å°æ–‡ä»¶ã€‚

- **Service Worker Cache** è¯¥éƒ¨åˆ†å¾…è¡¥å……ã€‚

> Service Worker æ˜¯ä¸€ç§ç‹¬ç«‹äºä¸»çº¿ç¨‹ä¹‹å¤–çš„ Javascript çº¿ç¨‹ã€‚å®ƒè„±ç¦»äºæµè§ˆå™¨çª—ä½“ï¼Œå› æ­¤æ— æ³•ç›´æ¥è®¿é—® DOMã€‚è¿™æ ·ç‹¬ç«‹çš„ä¸ªæ€§ä½¿å¾— Service Worker çš„â€œä¸ªäººè¡Œä¸ºâ€æ— æ³•å¹²æ‰°é¡µé¢çš„æ€§èƒ½ï¼Œè¿™ä¸ªâ€œå¹•åå·¥ä½œè€…â€å¯ä»¥å¸®æˆ‘ä»¬å®ç°ç¦»çº¿ç¼“å­˜ã€æ¶ˆæ¯æ¨é€å’Œç½‘ç»œä»£ç†ç­‰åŠŸèƒ½ã€‚æˆ‘ä»¬å€ŸåŠ© Service worker å®ç°çš„ç¦»çº¿ç¼“å­˜å°±ç§°ä¸º Service Worker Cacheã€‚

- **Push Cache** Push Cache æ˜¯æŒ‡ HTTP2 åœ¨ server push é˜¶æ®µå­˜åœ¨çš„ç¼“å­˜ã€‚å¾…è¡¥å……ã€‚

åˆç†è¿ç”¨è¿™äº›ç¼“å­˜ï¼Œå°½é‡ä¸è¦é¢‘ç¹çš„æ›´æ–°ä»£ç ï¼Œå› ä¸ºæ›´æ–°ä»£ç ä¹‹åhashå˜äº†ï¼Œå°±å¯¼è‡´ä¹‹å‰çš„ç¼“å­˜ç”¨ä¸äº†ã€‚

å½“ç„¶ï¼Œå¦‚æœæ¯æ¬¡æ›´æ–°éƒ½æ˜¯ä¸€äº›å°åŠŸèƒ½è¯ï¼Œåº”è¯¥ä¹Ÿåªæ˜¯å•çº¯å½±å“è¯¥åŠŸèƒ½çš„jsåŒ…ï¼Œå…¶ä»–çš„ç»å¤§å¤šæ•°ç¼“å­˜è¿˜æ˜¯æœ‰æ•ˆçš„ï¼ˆå†æ¬¡è¯´æ˜äº†åˆ†åŒ…çš„é‡è¦æ€§ï¼‰ã€‚

### æ‡’åŠ è½½

æ‡’åŠ è½½ä¸ºä»€ä¹ˆä¼šæ”¾åœ¨éé¦–å±å‘¢ï¼Œå› ä¸ºé¦–å±èµ„æºåŸºæœ¬ä¸Šåªéœ€è¦ä¿è¯å±•ç¤ºåœ¨ä¸€å±å†…çš„èµ„æºå¿«é€ŸåŠ è½½å‡ºæ¥å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥æˆ‘æŠŠå®ƒå½’ç±»åˆ°éé¦–å±äº†ã€‚

æ‡’åŠ è½½åœ¨[å›¾ç‰‡ä¼˜åŒ–](https://limaosheng.top/article/267a3baccfb99e62410b7ee01fcda399-3d4b2527bae6821f758a53e95bf42cb5-1.html)ä¹Ÿæœ‰ç®€å•çš„æåˆ°ï¼Œè¿™é‡Œæ¥è¯´ä»¥ä¸‹å®ƒçš„å…·ä½“å®ç°ã€‚

ä¸€èˆ¬ç°åœ¨çš„é¡¹ç›®éƒ½æ˜¯ç›´æ¥ä½¿ç”¨`IntersectionObserver`æ¥å®ç°å…ƒç´ çš„æ›å…‰ä¸æ˜¾ç¤ºï¼ŒçœŸæ˜¯ç®€å•æœ‰å¥½ç”¨ã€‚(ieä¸å…¼å®¹ï¼Œä½†æ˜¯æˆ‘å·²ç»æŠ›å¼ƒieäº†)

ç›´æ¥ä¸Šæ‰‹å†™ä¸€ä¸ªReactçš„Imageç»„ä»¶

```jsx
// ç›´æ¥ä½¿ç”¨ä¸€ä¸ªIntersectionObserverå®ä¾‹
const intersectionObserver = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.intersectionRatio > 0) { // åˆ¤æ–­æ˜¯å¦è¿›å…¥æ£€æµ‹åŒºåŸŸï¼ˆæ³¨æ„è¿™é‡Œæ˜¯æ£€æµ‹åŒºåŸŸä¸æ˜¯å¯è§†åŒºåŸŸï¼‰
      const targetImg = entry.target;
      if (!targetImg.src) { // å¦‚æœè¿›å…¥çš„å›¾ç‰‡å…ƒç´ æ²¡æœ‰srcå±æ€§ï¼Œåˆ™ç»™å®ƒèµ‹å€¼
        const src = targetImg.getAttribute('data-src');
        if (src) {
          targetImg.src = src;
          intersectionObserver.unobserve(targetImg); // èµ‹å€¼å®Œæˆä¹‹åæŠŠè¿™ä¸ªå·²ç»åŠ è½½èµ„æºçš„å…ƒç´ ä»æ£€æµ‹åˆ—è¡¨ä¸­ç§»é™¤
        }
      }
    }
  });
}, {
  rootMargin: '50% 50% 50% 50%', // å®šä¹‰æ£€æµ‹åŒºåŸŸå¤§å°ï¼Œè¿™é‡Œåˆ†åˆ«æ˜¯è·ç¦»å±å¹•å››è¾¹åŠä¸ªå±å¹•ï¼Œè¿™ä¹ˆåšçš„åŸå› æ˜¯å› ä¸ºä¸èƒ½è¿›å…¥è§†å›¾æ‰åŠ è½½ï¼Œä¼šæ¥ä¸åŠï¼Œæ‰€ä»¥å¾—æå‰åŠä¸ªå±å¹•åŠ è½½
});

export default class Image extends Component {
  ref = React.createRef();

  componentDidMount() {
    const { current } = this.ref;
    intersectionObserver.observe(current); // å°†è¯¥imgåŠ å…¥æ£€æµ‹
  }

  componentWillUnmount() {
    const { current } = this.ref;
    if (!current.src) {
      intersectionObserver.unobserve(current); // å¦‚æœç§»é™¤æ—¶è¿˜æ²¡è¿›å…¥è§†å›¾ï¼Œåˆ™ç§»é™¤æ£€æµ‹
    }
  }

  render() {
    return <img className="lazy-image" data-src={this.props.src} alt="" ref={this.ref} />;
  }
}
```

è¿™æ˜¯ä¸€ä¸ªå›¾ç‰‡ç›‘å¬çš„ç®€å•å®ç°ï¼Œå¯ä»¥æ‰©å±•ä¸€ä¸‹ï¼ŒåŠ ä¸ªæ˜¯å¦éœ€è¦æ‡’åŠ è½½çš„æ§åˆ¶ï¼Œæˆ–è€…åŠ class,styleçš„æ§åˆ¶ï¼ŒåŠ ä¸€äº›å›è°ƒå‡½æ•°ç­‰ã€‚

åŒæ—¶è¿™ä¸ä»…å¯ä»¥ä½œä¸ºæ‡’åŠ è½½çš„æ‰‹æ®µï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹ä¸€ä¸‹ä½œä¸ºä¸€ä¸ªæ›å…‰æ‰“ç‚¹çš„ç»„ä»¶ã€‚å…³é”®åœ¨ä¸ªäººæ€ä¹ˆä½¿ç”¨ã€‚

è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹`IntersectionObserver`åªæœ‰åœ¨æµè§ˆå™¨ç©ºé—²çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œï¼Œå¦‚æœä½ è®©æµè§ˆå™¨å¿™èµ·æ¥äº†ï¼Œé‚£å¯èƒ½è¿™ä¸ªäº‹ä»¶çš„è§¦å‘é¢‘ç‡å°±å¾ˆä½ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨`getBoundingClientRect`APIè‡ªå·±å°è£…ä¸€ä¸ªæ›å…‰ç›‘å¬å‡½æ•°ï¼Œä½†æ˜¯è¿™æ ·åšä¼šä½¿ä½ çš„æµè§ˆå™¨æ›´"å¿™"ã€‚

### å‡å°‘DOMäº¤äº’

ä¸DOMäº¤äº’çš„æ€§èƒ½æŸè€—æ˜¯å¾ˆå¤§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°½é‡å‡å°‘jsä¸domçš„äº¤äº’ã€‚å°½é‡å°†é‡å¤ä½¿ç”¨çš„domå˜é‡ç¼“å­˜èµ·æ¥ï¼Œä¸è¦æ¯æ¬¡éƒ½å»è·å–ã€‚

### é•¿åˆ—è¡¨ä¼˜åŒ–

å¾ˆå¤šäº§å“éƒ½æ‹¥æœ‰é•¿åˆ—è¡¨ï¼Œæ¯”å¦‚ç”µå•†ï¼Œæ¯”å¦‚è®ºå›ã€‚ä¸€èˆ¬è¿™ç§æµå¼çš„å†…å®¹éƒ½ä¼šæœ‰ä¸Šæ‹‰åŠ è½½çš„åŠŸèƒ½ï¼Œè€Œå½“ä½ ä¸Šæ‹‰æ¬¡æ•°è¶³å¤Ÿå¤šï¼Œä½ çš„domæ•°å°±ä¼šè¾¾åˆ°ä¸€ä¸ªåºå¤§çš„é‡ã€‚

å½“åˆ—è¡¨é¡¹è¾¾åˆ°1000+æ—¶ï¼Œæˆ–è®¸ä½ å°±ä¼šæ˜æ˜¾çš„æ„Ÿè§‰åˆ°ä½ çš„é¡µé¢å¼€å§‹å˜å¾—å¡é¡¿äº†ã€‚æ­¤æ—¶å°±è¦é‡‡å–ç­–ç•¥å»ä¼˜åŒ–é•¿åˆ—è¡¨äº†ã€‚

ç›®å‰å‰ç«¯å±‚é¢å¯¹äºé•¿åˆ—è¡¨çš„ä¼˜åŒ–å·®å¼ºäººæ„ï¼ŒåŸºæœ¬ä¸Šçš„åšæ³•éƒ½æ˜¯é€šè¿‡`getBoundingClientRect()`è®¡ç®—æˆ–è€…`IntersectionObserver`apiåˆ¤æ–­å…ƒç´ æ˜¯å¦æ›å…‰ï¼Œæˆ–è€…å¤„äºå³å°†æ›å…‰çš„çŠ¶æ€ï¼Œä»è€Œå†³å®šæ˜¯å¦æ¸²æŸ“åˆ—è¡¨é¡¹ã€‚

ä½†æ˜¯è¿™æ ·ä¼šäº§ç”Ÿç›‘å¬æˆ–è®¡ç®—å¤§é‡èŠ‚ç‚¹ï¼Œä¸domçš„äº¤äº’é¢‘ç¹å¯¼è‡´ä¼˜åŒ–æ•ˆæœä¸ç†æƒ³ã€‚

æˆ‘å†™äº†ä¸€ç¯‡[é•¿åˆ—è¡¨ä¼˜åŒ–æ–¹æ¡ˆ][https://limaosheng.top/article/5a9bdbdb0fc389b01f1a840d9a47600d-e6ebc01bd24898098c8acd6f4b4e73f3-1.html]ï¼Œé‡Œé¢è¯¦ç»†è§£é‡Šäº†é€šè¿‡jsè®¡ç®—èŠ‚ç‚¹é«˜åº¦åšçš„é•¿åˆ—è¡¨ä¼˜åŒ–æ‰‹æ®µã€‚

ä½¿ç”¨ğŸ‘‰[react-infinite-auto-scroller](https://github.com/sansui-orz/react-infinite-auto-scroller)

### åˆ©ç”¨Resource Hintsè¿›è¡Œèµ„æºçš„é¢„åŠ è½½

Respirce Hintsè§„èŒƒå®šä¹‰äº†å¦‚ä½•ä½¿ç”¨`<link>`æ ‡ç­¾çš„`dns-prefetch`, `preconnect`, `prefetch`, `prerender`å±æ€§æ§åˆ¶èµ„æºçš„åŠ è½½ã€‚ï¼ˆdnsé¢„è§£æ/é¢„é“¾æ¥/é¢„è·å–/é¢„æ¸²æŸ“ è¿˜æœ‰ é¢„åŠ è½½preloadï¼‰

Resource Hints ä½¿ç”¨ç®€å•ï¼Œå…¼å®¹æ€§å¥½ï¼Œä¸”ä¸ä¼šäº§ç”Ÿå‰¯ä½œç”¨ã€‚ä½•ä¹è€Œä¸ä¸ºå‘¢ã€‚

è¯¦ç»†ä»‹ç»ç‚¹å‡» ğŸ‘‰[Resource Hintsä»‹ç»](https://limaosheng.top/article/91696f0ea475f9b29620f04910dbb1d4-cb51e9764c96e29658a520fe703de9ab-1.html)

### ç»„ä»¶æ¸²æŸ“å¼‚å¸¸å…œåº•

åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¤§å¤šæ•°äººåº”è¯¥é‡è§è¿‡â€œä¸€ä¸ªæ•°æ®ç»“æ„é”™è¯¯å¯¼è‡´é¡µé¢ç©ºç™½â€çš„é—®é¢˜ï¼Œå¾€å¾€è¿™ç§é”…æ˜¯å¯ä»¥ä¸¢ç»™åç«¯åŒäº‹çš„ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯è¯´å‰ç«¯æ¯«æ— è´£ä»»ï¼Œå› ä¸ºé¡µé¢ç©ºç™½æ˜¯å¯ä»¥é¿å…çš„ï¼Œåªæ˜¯ä½ æ²¡åšè€Œå·²ã€‚

```javascript
let DefaultErrorComponent = null;

export function setDefaultErrorComponent(ErrorComponent) {
  DefaultErrorComponent = ErrorComponent;
}

export default function createCatchError(Component, ErrorComponent) {
  return class CatchErrore extends React.Component {
    state = {
      hasError: false,
    };

    static getDerivedStateFromError(error) { // getDerivedStateFromErrorä¸componentDidCatchéƒ½å¯ä»¥ç”¨æ¥æ•è·ç»„ä»¶æ¸²æŸ“äº§ç”Ÿçš„é”™è¯¯
      console.log(error);
      return { hasError: true };
    }

    // componentDidCatch() { è¿™ä¸ªæ–¹æ³•åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­ä¼šè¢«ç§»é™¤
    //   this.setState({ hasError: true });
    // }

    render() {
      if (this.state.hasError) {
        return ErrorComponent ? <ErrorComponent {...this.props} /> : (DefaultErrorComponent ? <DefaultErrorComponent {...this.props}/> : null)
      }
      return <Component {...this.props} />;
    }
  }
}
```

ä¸Šé¢å°±æ˜¯ä¸€ä¸ªç®€æ˜“çš„æ¸²æŸ“å¼‚å¸¸å…œåº•ç»„ä»¶ï¼Œä½¿ç”¨é«˜é˜¶å‡½æ•°å°†éœ€è¦å…œåº•çš„ç»„ä»¶ä¸å¼‚å¸¸æ—¶æ˜¾ç¤ºçš„ç»„ä»¶ä¸€åŒä¼ å…¥ï¼Œè¿”å›ä¸€ä¸ªå…œåº•åçš„ç»„ä»¶ï¼ŒåŒæ—¶æä¾›è®¾ç½®é»˜è®¤å…œåº•ç»„ä»¶çš„èƒ½åŠ›ã€‚

è¿™æ ·é‡åˆ°åç«¯è¿”å›æ•°æ®é”™è¯¯çš„æ—¶å€™ä¹Ÿèƒ½å¤Ÿä¿è¯æ•´ä¸ªé¡µé¢ä¸ä¼šæŒ‚æ‰ï¼Œè€Œä»…ä»…æ˜¯æ•°æ®å¼‚å¸¸çš„é‚£ä¸€å°å—å†…å®¹æ˜¾ç¤ºå‡ºé”™è¯¯æé†’ã€‚

### è¿è¡Œä¼˜åŒ–ï¼ˆèŠ‚æµä¸é˜²æŠ–ï¼‰

è™½è¯´æˆ‘ç»å¸¸æ— æ³•å°†èŠ‚æµä¸é˜²æŠ–çš„æ¦‚å¿µä¸å…¶åç§°ä¸€ä¸€å¯¹åº”èµ·æ¥ï¼Œä½†æ˜¯åœ¨æ—¥å¸¸å·¥ä½œä¸­è¿˜æ˜¯ç»å¸¸ä¼šé‡åˆ°éœ€è¦ä½¿ç”¨åˆ°èŠ‚æµä¸é˜²æŠ–çš„åœºæ™¯ã€‚

æ¯”å¦‚è¯´åœ¨ç›‘å¬åˆ—è¡¨æ»šåŠ¨æ—¶å°±ç»å¸¸éœ€è¦ä½¿ç”¨åˆ° **èŠ‚æµ**ï¼Œè€Œåœ¨ç”¨æˆ·è¾“å…¥æ–‡æœ¬çš„æ—¶å€™åˆ™æ¯”è¾ƒå¸¸ç”¨ **é˜²æŠ–**ã€‚

- ã€ŒèŠ‚æµthrottleã€ï¼Œè§„å®šåœ¨ä¸€ä¸ªå•ä½æ—¶é—´å†…ï¼Œåªèƒ½è§¦å‘ä¸€æ¬¡å‡½æ•°ã€‚å¦‚æœè¿™ä¸ªå•ä½æ—¶é—´å†…è§¦å‘å¤šæ¬¡å‡½æ•°ï¼Œåªæœ‰ä¸€æ¬¡ç”Ÿæ•ˆã€‚

- ã€Œé˜²æŠ–debounceã€,åœ¨äº‹ä»¶è¢«è§¦å‘nç§’åå†æ‰§è¡Œå›è°ƒï¼Œå¦‚æœåœ¨è¿™nç§’å†…åˆè¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶ã€‚

å…¶ç»†èŠ‚å¯ä»¥çœ‹ä¸€ä¸‹ğŸ‘‰ [èŠ‚æµé˜²æŠ–çš„ç®€å•å®ç°](https://limaosheng.top/article/dce61d34290f90fb3f01cab144927c1d-7f992e22391d98f00b54d483290fa620-1.html)

å¦‚æœé¡µé¢ä¸­æœ‰ç±»ä¼¼scroll/resizeè¿™ç±»çš„éœ€æ±‚çš„è¯ï¼Œå»ºè®®è¿˜æ˜¯åŠ ä¸ŠèŠ‚æµæˆ–è€…é˜²æŠ–ï¼Œå› ä¸ºå®ƒä¼šé¢‘ç¹è§¦å‘ã€‚

### Reactä¸­çš„äº‹ä»¶ç»‘å®šä¼˜åŒ–

ç»å¸¸åœ¨åˆ«äººå†™çš„reactä¸­çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„ä»£ç ï¼š

```javascript
  // ...
  eventHandle() {}

  render() {
    return (
      <div>
        {this.state.list.map(item => {
          return <Component eventHandle={() => this.eventHandle()}/>;
          /** æˆ–è€…è¿™æ ·
          * return <Component eventHandle={this.eventHandle.bind(this)}/>;
          */
        })}
      </div>
    );
  }
  // ...
```

ä¹ä¸€çœ‹æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œé¡¹ç›®è·‘èµ·æ¥ä¹Ÿå¾ˆå®Œç¾ï¼Œä½†æ˜¯è¿™é‡Œçš„eventHandleä¸åº”è¯¥ç”¨ç®­å¤´å‡½æ•°ã€‚

å¦‚æœè¿™é‡Œä½¿ç”¨çš„æ˜¯ç®­å¤´å‡½æ•°ï¼Œé‚£ä¹ˆæ¯æ¬¡renderçš„æ—¶å€™éƒ½ä¼šå¾ªç¯åˆ›å»ºnä¸ªå‡½æ•°ç»‘å®šï¼Œè¿™å¹¶ä¸å¿…è¦ã€‚é€šå¸¸å¦‚æœä¸éœ€è¦ä¼ é€’åˆ—è¡¨é¡¹çš„å‚æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦å°†thisåœ¨å£°æ˜é˜¶æ®µç»‘å®šä¸Šå»å°±å¥½äº†ï¼Œå¾ˆç®€å•ï¼Œå°†ç®­å¤´å‡½æ•°æŒªä¸€ä¸‹ä½ç½®ã€‚

```javascript
  // ...
  eventHandle = () => {}

  render() {
    return (
      <div>
        {this.state.list.map((item, index) => {
          return <Component key={index} eventHandle={this.eventHandle}/>;
        })}
      </div>
    );
  }
  // ...
```

è¿™æ ·æˆ‘ä»¬æ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™éƒ½æ˜¯å¤ç”¨äº†ä¸€ä¸ªå‡½æ•°ï¼Œæ€§èƒ½åˆå¾—åˆ°äº†ä¸€ä¸¢ä¸¢çš„æå‡ã€‚

ä½†æ˜¯è¿™ç§éƒ½æ˜¯æ²¡æœ‰é€’å½’ä¼ å‚çš„æ—¶å€™æ‰ä¼šè¿™ä¹ˆä½¿ç”¨ï¼Œå¦‚æœéœ€è¦ç”¨åˆ°itemä¼ å‚å‘¢ï¼Ÿ

å…¶å®æˆ‘ä»¬å¯ä»¥å°†å‚æ•°ä¼ å…¥ç»„ä»¶ä¸­ï¼Œåœ¨ç»„ä»¶ä¸­è§¦å‘çš„æ—¶å€™å†å°†å‚æ•°ä¼ å›æ¥ï¼Œè¿™æ ·åŒæ ·ä¸éœ€è¦å£°æ˜å¤šä¸ªå‡½æ•°ã€‚

```javascript
  // ...
  eventHandle = (item) => {}

  render() {
    return (
      <div>
        {this.state.list.map((item, index) => {
          return <Component key={index} item={item} eventHandle={this.eventHandle}/>;
        })}
      </div>
    );
  }
  // ...
```

æˆ–è®¸è¿™æ—¶å€™ä¼šæœ‰æ ç²¾è¯´â€œä½ è¿™æ˜¯reactç»„ä»¶æ‰èƒ½è¿™ä¹ˆç”¨å§ï¼Œå¦‚æœæˆ‘å¾ªç¯éå†å‡ºæ¥çš„æ˜¯æ¯”è¾ƒç®€å•çš„domç»“æ„å‘¢ï¼Ÿâ€ã€‚

å³ä½¿æ˜¯ç®€å•domç»“æ„ä¹Ÿæ˜¯å¯ä»¥ä¼˜åŒ–çš„ã€‚

```javascript
  // ...
  eventHandle = (event) => {
    var index = +event.target.getAttrivute('data-index');
    var item = this.state.list[index];
    // ...
  }

  render() {
    return (
      <div>
        {this.state.list.map((_, index) => {
          return <div key={index} data-index={index} eventHandle={this.eventHandle}></div>;
        })}
      </div>
    );
  }
  // ...
```

#### ç”šè‡³æ˜¯ä½¿ç”¨äº‹ä»¶ä»£ç†

è¿˜æœ‰ä¸€ç§å¤è€çš„æ‰‹æ®µå¯ä»¥å®Œç¾çš„è§£å†³è¿™ä¸ªéå†ç»‘å®šäº‹ä»¶çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯äº‹ä»¶ä»£ç†ï¼Œä½¿ç”¨äº‹ä»¶ä»£ç†å¯ä»¥è®©ä½ å‡å°‘å¯¹domçš„å¼•ç”¨ï¼Œä»¥åŠå‡å°‘å‡½æ•°çš„å£°æ˜ã€‚

äº‹ä»¶ä»£ç†åªæœ‰ä¸€ç‚¹æ˜¯éœ€è¦æ³¨æ„çš„ï¼Œé‚£å°±æ˜¯å½“ç‚¹å‡»éœ€è¦å“åº”çš„å…ƒç´ çš„å­å…ƒç´ æ—¶ï¼Œå¦‚ä½•åˆ¤æ–­è¿™ä¸ªå­å…ƒç´ åœ¨éœ€è¦å“åº”å…ƒç´ å†…ã€‚

ç›®å‰ä¸»è¦æœ‰ä¸¤ä¸ªæ–¹å¼ï¼Œ1. ä½¿ç”¨matchesæ–¹æ³•ï¼Œ2. å¾ªç¯éå†ã€‚

ä½†æˆ‘æ›´å€¾å‘äºä¸¤è€…ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚

```javascript
element.addEventListener('click', e => {
  if(e.target.matches('li') || e.target.matches('li *')) {
    var eventElement = e.target;
    while (eventElement && eventElement.getAttribute('data-event') !== 'eventName') {
      if (eventElement === element) {
        eventElement = null;
        break;
      }
      eventElement = eventElement.parentNode;
    }
    // todo ...
  }
})
```

### è·³è½¬å‰è¯·æ±‚

ç»å¸¸ï¼Œæˆ‘ä»¬è¿›å…¥ä¸€ä¸ªé¡µé¢åï¼Œä¼šåœ¨è¯¥é¡µé¢ç»„ä»¶çš„`componentDidMount`ä¸­å‘èµ·æ•°æ®è¯·æ±‚ï¼Œä½†æ˜¯å…¶å®åœ¨è·³è½¬åˆ°è¯·æ±‚ä¹‹é—´å­˜åœ¨äº†ä¸€å®šçš„ç©ºæ¡£æœŸï¼Œå°½ç®¡è·³è½¬å¹¶ä¸æ˜¯éå¸¸è€—æ—¶ï¼Œä½†æ˜¯å½“é¡µé¢æ˜¯é€šè¿‡åŠ¨æ€åŠ è½½çš„ï¼Œæ­¤æ—¶æ•°æ®è¯·æ±‚çš„å‘å‡ºæ—¶é—´å°±è¦ä¾èµ–äºé¡µé¢çš„åŠ è½½æ—¶é—´ã€‚

é‚£ä¹ˆè¿™æ®µæ—¶é—´æ˜¯ä¸æ˜¯å¯ä»¥çœç•¥çš„å‘¢ï¼Ÿç­”æ¡ˆå¾ˆæ˜æ˜¾ï¼Œåªè¦åœ¨é¡µé¢è·³è½¬æ—¶åŒæ­¥å‘èµ·æ•°æ®è¯·æ±‚ï¼Œå½“é¡µé¢è¯·æ±‚&æ¸²æŸ“äºæ•°æ®è¯·æ±‚å¹¶è¡Œï¼Œé‚£ä¹ˆæ—¶é—´å°±å¯ä»¥ä»â€œn+nâ€å˜æˆ"n"ï¼Œå¦‚æœä½ çš„æ¥å£å“åº”é€Ÿåº¦å¿«ï¼Œè¯´ä¸å®šé¡µé¢æ¸²æŸ“å‡ºæ¥æ—¶ç«‹å³ä¾¿å¯ä»¥çœ‹åˆ°å®Œæ•´çš„æ•°æ®ã€‚

æ€ä¹ˆåšï¼Ÿç”±äºreactçš„classç»„ä»¶åªä¼šå“åº”è‡ªèº«stateçš„å˜æ›´ï¼ˆæˆ–è€…propsçš„å˜æ›´ï¼‰ã€‚è‡ªèº«çš„stateåªæœ‰åœ¨ç»„ä»¶åˆ›å»ºä¹‹åæ‰ä¼šåˆå§‹åŒ–ã€‚æ‰€ä»¥åªèƒ½é€šè¿‡ç¬¬ä¸‰æ–¹çŠ¶æ€åº“æ¥å®ç°äº†ã€‚

ä¾‹å¦‚`redux` / `mobx`éƒ½å¯ä»¥ç®€å•çš„å®ç°ä¸€ä¸ªé¡µé¢å¯¹åº”ä¸€ä¸ª`store`ï¼Œç„¶åå°†çº¿ä¸Šæ•°æ®éƒ½ä¿å­˜åœ¨storeå†…ï¼Œå°±æ—¢å¯ä»¥å°†è¯·æ±‚ä¸ç»„ä»¶åˆ†ç¦»ï¼Œåˆå¯ä»¥èµ·åˆ°ç¼“å­˜æ•°æ®çš„æ•ˆæœã€‚ï¼ˆå¹¶ä¸”ç»™è¯·æ±‚å‡½æ•°åšå•å…ƒæµ‹è¯•ä¹Ÿæ›´åŠ æ–¹ä¾¿ï¼‰ã€‚

~~æœ€åï¼Œæˆ–è®¸reactæ–°æ¨å‡ºçš„hooksä¹Ÿå¯ä»¥èµ·åˆ°å…¨å±€çŠ¶æ€ç®¡ç†çš„ä½œç”¨ï¼Œè¿™å—åé¢å†è¡¥ä¸Šç›¸åº”çš„æ–‡ç« è¯¦ç»†ä»‹ç»ä¸€ä¸‹å§ï¼~~

å…³äºå¦‚ä½•ä½¿ç”¨`React Hooks`ç®€å•å®ç°å…¨å±€çŠ¶æ€ç®¡ç†ï¼Œå¯ä»¥å‚è€ƒå¦ä¸€ç¯‡ä»‹ç» [Reactä½¿ç”¨useReducerå®ç°å…¨å±€çŠ¶æ€ç®¡ç†](https://limaosheng.top/article/be57b3cca33f5f2c020890c40ecdcb01-40d37f8f67f14409943d15e94e89229c-1.html)

### ä½¿ç”¨ç¦»çº¿åº”ç”¨æŠ€æœ¯(pwa)

å¦‚æœä½ çš„åº”ç”¨å¯¹äºç”¨æˆ·æ¥è¯´æ˜¯ä¸€ä¸ªå¼ºä¾èµ–æ€§å¼ºçº¦æŸå‹çš„åº”ç”¨ï¼Œé‚£ä¹ˆä½ å¯ä»¥è€ƒè™‘ä¸€ä¸‹ä½¿ç”¨`service worker`å°†æ•´ä¸ªåº”ç”¨ç¦»çº¿èµ·æ¥ã€‚

ä¸ºä»€ä¹ˆéœ€è¦å¼ºä¾èµ–æ€§å¼ºçº¦æŸæ€§çš„æ‰æ¨èç”¨pwaå‘¢ï¼Œå› ä¸ºpwaæ›´æ–°æ¯”è¾ƒéº»çƒ¦ï¼Œå¯èƒ½å‡ºç°ä½ å·²ç»å‘å¸ƒäº†æ–°çš„ç‰ˆæœ¬ï¼Œä½†æ˜¯ç”¨æˆ·æ‰‹æœºä¸Šåˆ·äº†ä¸¤ä¸‰éè¿˜æ˜¯è€ç‰ˆæœ¬çš„æƒ…å†µã€‚æ‰€ä»¥å¯¹äºè¿­ä»£é€Ÿåº¦å¿«çš„äº§å“æœ€å¥½è¿˜æ˜¯åˆ«éšä¾¿ä¸Špwa, åæœŸç®¡ç†èµ·ç¼“å­˜çŠ¶æ€ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚

è¯¦ç»†çš„æŠ€æœ¯ä¼˜åŒ–ç‚¹å¯ä»¥æŸ¥çœ‹[åº”ç”¨ç¼“å­˜ä¸pwa](https://limaosheng.top/article/c8cc58c1c5eba4807810f86bad94c955-5199e8bbf801065139abf9835fbcce0a-1.html)

### å¯†é›†å‹è®¡ç®—ä»»åŠ¡è¯·ä½¿ç”¨web worker

å¯†é›†å‹çš„è®¡ç®—å› ä¸ºjsçš„å•è¿›ç¨‹çš„å½±å“ä¼šå µå¡jsçš„æ‰§è¡Œï¼Œæ‰€ä»¥æœ€ä½³å®è·µæ˜¯å°†å¤§é‡çš„è®¡ç®—ä»»åŠ¡äº¤ç»™web workerã€‚

### cssä¼˜åŒ–

1. cssåµŒå¥—è§„åˆ™ä¸è¦è¶…è¿‡3å±‚ã€‚ï¼ˆcssçš„åŒ¹é…è§„åˆ™æ˜¯ä»å³åˆ°å·¦çš„ï¼Œä¹Ÿå°±æ„å‘³ç€`.a .b .c`ä¼šä¼˜å…ˆåŒ¹é…æ‰€æœ‰`.c`çš„å…ƒç´ ï¼Œå†åŒ¹é…`.b`ä¸`.a`ï¼Œæ‰€ä»¥æœ€å¥½ä½¿ç”¨è¾ƒä¸ºæ˜ç¡®çš„ç±»åã€‚

2. cssç±»ååˆ†æ¨¡å—åˆ’åˆ†å¥½ï¼Œä¸”å¸¸è§çš„ç±»åä¸€å®šè¦åŠ çˆ¶ç±»åçº¦æŸã€‚

```css
/* bad */
.btn {
  font-size: 24px;
}
```

```css
/* good */
.notice-component .btn {
  font-size: 24px;
}
```

## æ€»ç»“

å¯¹äºé¦–å±ï¼Œæˆ‘ä»¬è¦æ§åˆ¶å¥½èµ„æºçš„å¤§å°ï¼ˆä»£ç ä¸å›¾ç‰‡ï¼‰ï¼Œå®‰æ’å¥½èµ„æºåŠ è½½çš„é¡ºåºï¼Œåˆ©ç”¨å¥½cdnï¼Œå¿…è¦æ—¶ä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚

å¯¹äºéé¦–å±ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å…³æ³¨ç¼“å­˜çŠ¶å†µï¼Œå…³æ³¨ä»£ç æ‰§è¡Œæ•ˆç‡ã€‚

åˆ«å°çœ‹æ¯ä¸€ä¸ªæ€§èƒ½ä¼˜åŒ–çš„å°æŠ€å·§ï¼Œå¯èƒ½æ¯ä¸ªå°æŠ€å·§èƒ½å¤Ÿæå‡çš„æ€§èƒ½æœ‰é™ï¼Œä½†æ˜¯å½“è¿™äº›æ€§èƒ½ç´¯ç§¯èµ·æ¥ï¼Œå´èƒ½è®©ä½ çš„ä»£ç é«˜æ•ˆçš„è¿è¡Œèµ·æ¥ã€‚

> å…¶å®æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸ä»…æ˜¯å‰ç«¯ï¼‰æ— éå°±æ˜¯å‡ ç‚¹ï¼Œâ€œå¹¶è¡Œï¼ˆå¹¶å‘ï¼‰ï¼Œé¢„åŠ è½½ï¼ˆé¢„æ¸²æŸ“ï¼‰ï¼Œæ‡’åŠ è½½ï¼ˆåˆ†åŒ…&å›¾ç‰‡ï¼‰ï¼Œå¤ç”¨ï¼ˆå®ä¾‹ï¼‰ï¼Œç¼“å­˜ï¼ˆæ•°æ®/æ–‡ä»¶ï¼‰ï¼Œå‹ç¼©ï¼ˆä»£ç /æ•°æ®ï¼‰â€ï¼Œä»æ¯ä¸€ç‚¹å…¥æ‰‹ï¼Œæ·±å…¥ä¼˜åŒ–ï¼Œå¤šé—®é—®è‡ªå·±è¿˜èƒ½åšä»€ä¹ˆï¼Œæ€§èƒ½è‡ªç„¶å°±ä¸Šå»äº†ã€‚

## å‚è€ƒæ–‡æ¡£

[å‰ç«¯æ€§èƒ½ä¼˜åŒ–åŸç†ä¸å®è·µ](https://juejin.im/book/5b936540f265da0a9624b04b)

[é•¿åˆ—è¡¨ä¼˜åŒ–æ–¹æ¡ˆ](https://limaosheng.top/article/5a9bdbdb0fc389b01f1a840d9a47600d-e6ebc01bd24898098c8acd6f4b4e73f3-1.html)

[å›¾ç‰‡ä¼˜åŒ–å®è·µ](https://limaosheng.top/article/267a3baccfb99e62410b7ee01fcda399-3d4b2527bae6821f758a53e95bf42cb5-1.html)

[Resource Hintsä»‹ç»](https://limaosheng.top/article/91696f0ea475f9b29620f04910dbb1d4-cb51e9764c96e29658a520fe703de9ab-1.html)

[reactæœåŠ¡ç«¯æ¸²æŸ“é¡¹ç›®æ­å»º](https://limaosheng.top/article/4d37df30f18a94691d2db50df55a4e13-6428f8ce98aebc5faacc01038f3478dc-1.html)

[Httpç¼“å­˜æœºåˆ¶](https://limaosheng.top/article/b58066a85e6629d0f3def482cd72cc5a-6d3a6155b48b9c57245fcd95a154bf04-1.html)

[Reactä½¿ç”¨useReducerå®ç°å…¨å±€çŠ¶æ€ç®¡ç†](https://limaosheng.top/article/be57b3cca33f5f2c020890c40ecdcb01-40d37f8f67f14409943d15e94e89229c-1.html)

[åº”ç”¨ç¼“å­˜ä¸pwa](https://limaosheng.top/article/c8cc58c1c5eba4807810f86bad94c955-5199e8bbf801065139abf9835fbcce0a-1.html)
